import React, { useState, useEffect } from 'react';
import { Layout, Progress, Avatar } from 'antd';
import userIcon from '../../assets/img/icon_user.png';
import { findUser, findBanker } from '../../utils/userStorage';
import { useSelector } from 'react-redux';
import { RootState } from '../../hoc/store';

const { Content } = Layout;

const getNickname = (): string => {
  const nickname = localStorage.getItem('nickname');
  return nickname? nickname : 'None'
}

const UserInfo: React.FC = () => {
  const [nicknameOrRealname, setNicknameOrRealname] = useState<string>('Loading...'); // λ‹‰λ„¤μ„ μƒνƒ κ΄€λ¦¬
  const isLoggedIn = useSelector((state: RootState) => state.auth.isAuthenticated);
  const userRole = useSelector((state: RootState) => state.auth.userRole);

  // ν„μ¬ λ΅κ·ΈμΈν• μ‚¬μ©μ ν™•μΈ
  useEffect(() => {  
    if (isLoggedIn) {
      const nickname = getNickname();

      if (userRole == 'C') {
        // κ³ κ°μ΄λΌλ©΄
        setNicknameOrRealname(nickname); // λ‹‰λ„¤μ„ μ„¤μ •
      } else if (userRole == 'B') {
        // ν–‰μ›μ΄λΌλ©΄
        setNicknameOrRealname(nickname);
      }
    }
  }, []);

  return (
    <Layout
      style={{
        padding: '24px 50px',
        backgroundColor: '#fff',
        minHeight: '45vh',
      }}
    >
      <Content
        style={{
          textAlign: 'center',
        }}
      >
        {/* μ…μ²΄μ μΈ μ•„λ°”νƒ€ */}
        <Avatar
          size={100}
          src={userIcon}
          style={{
            marginBottom: '20px',
            border: '4px solid #1890ff',
            boxShadow: '0 8px 20px rgba(0, 0, 0, 0.15)',
            animation: 'float 3s ease-in-out infinite',
          }}
        />

        {/* μ‚¬μ©μ μ΄λ¦„ */}
        <h2
          style={{
            fontSize: '30px',
            fontWeight: 'bold',
            marginBottom: '10px',
            color: '#333',
            textShadow: '1px 1px 2px rgba(0, 0, 0, 0.2)', // ν…μ¤νΈ κ°•μ΅°
          }}
        >
          {nicknameOrRealname}
        </h2>

        {/* ν¬μΈνΈ ν‘μ‹ */}
        <p
          style={{
            fontSize: '18px',
            color: '#666',
            marginBottom: '20px',
          }}
        >
          π μ§€κµ¬ 1380 ν¬μΈνΈ
        </p>

        {/* μ§„ν–‰λ¥  λ°” */}
        <Progress
          percent={60}
          status="active"
          strokeWidth={12}
          showInfo={true}
          strokeColor={{
            '0%': '#87e8de',
            '100%': '#1890ff',
          }}
          style={{
            width: '100%',
            marginTop: '20px',
            animation: 'progressPop 1.5s ease-in-out',
          }}
        />
      </Content>
    </Layout>
  );
};

export default UserInfo;
